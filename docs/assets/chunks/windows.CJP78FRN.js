import{a as p,e as x}from"./index.CASokwIO.js";const z=5,u=6,f=10;let I=(t,n,s,i)=>(t.events=t.events||{},t.events[s+f]||(t.events[s+f]=i(e=>{t.events[s].reduceRight((d,o)=>(o(d),d),{shared:{},...e})})),t.events[s]=t.events[s]||[],t.events[s].push(n),()=>{let e=t.events[s],d=e.indexOf(n);e.splice(d,1),e.length||(delete t.events[s],t.events[s+f](),delete t.events[s+f])}),M=1e3,T=(t,n)=>I(t,i=>{let e=n(i);e&&t.events[u].push(e)},z,i=>{let e=t.listen;t.listen=(...o)=>(!t.lc&&!t.active&&(t.active=!0,i()),e(...o));let d=t.off;return t.events[u]=[],t.off=()=>{d(),setTimeout(()=>{if(t.active&&!t.lc){t.active=!1;for(let o of t.events[u])o();t.events[u]=[]}},M)},()=>{t.listen=e,t.off=d}}),A=(t,n,s)=>{Array.isArray(t)||(t=[t]);let i,e,d=()=>{if(e===x)return;e=x;let c=t.map(r=>r.get());if(!i||c.some((r,m)=>r!==i[m])){i=c;let r=n(...c);r&&r.then&&r.t?r.then(m=>{i===c&&o.set(m)}):(o.set(r),e=x)}},o=p(void 0),h=o.get;o.get=()=>(d(),h());let l=d;return T(o,()=>{let c=t.map(r=>r.listen(l));return d(),()=>{for(let r of c)r()}}),o};const O=(t,n)=>A(t,n),a=p([]),g=p(10),w=p(null),W=40,E=5;function L(t){const n={home:{size:{width:500,height:400}},work:{size:{width:900,height:700}},links:{size:{width:450,height:400}},about:{size:{width:500,height:500}},faq:{size:{width:500,height:400}},autism:{size:{width:600,height:500}}};return t.startsWith("blog-")?{size:{width:1e3,height:800}}:n[t]||{size:{width:650,height:500}}}function v(t,n,s,i){const e=(s-t.width)/2,d=(i-t.height)/2,o=n%E,h=e+o*W,l=d+o*W,c=s-t.width-10,r=i-t.height-10;return{x:Math.max(10,Math.min(h,c)),y:Math.max(10,Math.min(l,r))}}function N(t){if(t.startsWith("blog-")){const n=t.replace("blog-","");return{"project-1":"Personal Website","project-2":"Machine Learning Art","project-3":"NixOS Configuration"}[n]||`Blog: ${n}`}return t.split("-").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")}function S(t){const n=a.get();if(n.find(l=>l.id===t)){U(t);return}const i=L(t),e=i.size||{width:650,height:500},d=v(e,n.length,typeof window<"u"?window.innerWidth:1024,typeof window<"u"?window.innerHeight:768),o=g.get()+1;g.set(o);const h={id:t,title:i.title||N(t),position:d,size:e,zIndex:o,isOpen:!0,isLoading:!0};a.set([...n,h]),w.set(t),setTimeout(()=>{const l=a.get();a.set(l.map(c=>c.id===t?{...c,isLoading:!1}:c))},300)}function _(t){const n=a.get();if(a.set(n.filter(s=>s.id!==t)),w.get()===t){const i=n.filter(e=>e.id!==t).sort((e,d)=>d.zIndex-e.zIndex)[0];w.set(i?.id||null)}}function U(t){const n=a.get();if(!n.find(e=>e.id===t))return;const i=g.get()+1;g.set(i),a.set(n.map(e=>e.id===t?{...e,zIndex:i,isOpen:!0}:e)),w.set(t)}function D(t,n){const s=a.get();a.set(s.map(i=>i.id===t?{...i,position:n}:i))}function R(){if(typeof window>"u")return;const t=a.get(),n=window.innerWidth,s=window.innerHeight;a.set(t.map((i,e)=>({...i,position:v(i.size,e,n,s)})))}const F=O(a,t=>[...t].sort((n,s)=>n.zIndex-s.zIndex));export{a as $,w as a,F as b,_ as c,U as d,D as m,S as o,R as r};
